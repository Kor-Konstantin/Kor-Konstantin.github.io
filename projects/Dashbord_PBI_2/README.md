## Итоговый проект по курсу «Power BI и Excel для продвинутых»
  ## Отчет об экономических результатах деятельности департамента
  1. Описание задачи

Вы работаете аналитиком в департаменте пассивных операций банка, специализирующегося на
привлечении денежных средств от крупных компаний из разных отраслей экономики. Сами
клиенты разбиты на три сегмента: глобальные компании (ТНК), крупный бизнес (КБ) и
государственные компании (ГК). Вам требуется разработать отчет об экономических результатах
деятельности Вашего департамента. Результат - отчет в Power BI.

2. Описание данных

Данные по каждому сегменту содержатся в соответствующих папках в файлах: «Движение ДС.xlsx»
и «Список клиентов.pdf». Все папки сегментов содержаться в папке «Исходные данные».
1. Файл «Движение ДС.xlsx». Содержит данные о приходах денежных средств (ДС) на депозиты
и выплат ДС с депозитов. В таблице ниже указаны столбцы исходной таблицы и описание
содержимого каждого столбца.

| Название поля | Описание |
| --- | --- |
| Клиент | Название клиента, который осуществляет операцию. |
| Валюта | Валюта, в которой проводятся операции. Возможные валюты: доллары, евро и рубли. |
| Дата   | Дата, когда была проведена операция. |
| Сумма  | Сумма операции. Положительная сумма означает внесение денежных средств на депозит, отрицательная сумма — выплату.

Файл «Список клиентов.pdf». Содержит выписку из реестра клиентов банка, состоящую из
блоков, описывающих клиентов. Каждый блок содержит следующую информацию в
указанном ниже порядке:
• город обслуживания;
• отрасль;
• названия клиентов и, следуя за названием, ставки, под которую от данного клиента
принимаются депозиты в каждой из валют. В силу требований безопасности, в
исходных данных настоящие названия клиентов заменены кодами вида «Клиент-
<номер>». Обратите внимание, что нумерация клиентов разных сегментов не
сквозная, а повторяющаяся. То есть в разных сегментах есть, например, Клиент-1.
При этом это – разные клиенты.
К сожалению, единственная форма, в которой возможно будет выгружать реестр клиентов
из банковской CRM – список. Поэтому при загрузке данных из реестра в модель нужно будет
предусмотреть необходимые преобразования.

![Пример таблицы](/projects/Dashbord_PBI_2/1.png)
*Файл список клиентов до обработки*
![2](/projects/Dashbord_PBI_2/2.png)
*Таблица полученная после преобразований в POWER QUERY *
3. Показатели

Требуется получить следующие показатели:

- Привлеченные ДС. Рассчитывается как сумма всех привлеченных за период ДС
- Выплаченные ДС. Рассчитывается как сумма всех выплаченных за период ДС
- Начисленные проценты. Рассчитывается как сумма процентов, начисленных за каждый
день периода. 
- Остаток ДС на конец дня рассчитывается как остаток ДС на начало дня плюс приход ДС за
день минус расход ДС. Если остаток отрицательный (клиент ушел в овердрафт), проценты
не начисляются.
- Задолженность. Рассчитывается на дату как (Привлеченные ДС) + (Начисленные проценты) – (Выплаченные ДС)
за выбранный пользователем период.
- Средний размер депозита. Рассчитывается как сумма всех привлеченных за период ДС,
деленная на общее число привлеченных за период депозитов.
4. Результат проделанной работы
  
Результатом работы является проект выполненный в Power BI.
Модель данных состоит из 6 связанных между собой таблиц и 2 вспомогательных таблиц, не связанных с остальными.

![3](/projects/Dashbord_PBI_2/3.png)
*Модель данных*
Расчеты метрик выполнены с помощью языка DAX, внешний вид отчета представлен ниже.
![4](/projects/Dashbord_PBI_2/4.png)
*Первая страница отчета, по динамике средств*
![5](/projects/Dashbord_PBI_2/5.png)
*Вторая странца отчеа отображающая начисленные проценты и задолженость*
![6](/projects/Dashbord_PBI_2/6.png)
*Третья страница отображает показатель средний размер депозита*
![7](/projects/Dashbord_PBI_2/7.png)
*Внешний вид отчета в валюте приведения*
